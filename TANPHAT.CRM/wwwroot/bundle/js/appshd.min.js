(function(){app.controller("Shared.Header",["$scope","$rootScope","$state","authService","notificationService","$uibModal",function(n,t,i,r,u,f){var e=this,o;$(".sidebar-toggler").click(function(){return $(".sidebar, .navbar, .content-TP").toggleClass("open"),$(".me-4").toggleClass("open"),!1});getLocalStorage("setting")!=null?(e.isShowHeader=getLocalStorage("setting")=="true",e.isShowHeader==!0&&setTimeout(function(){$(".sidebar-toggler").click()},10)):(setLocalStorage("setting",!1),e.isShowHeader=!1);e.changeState=function(n=true){n&&(e.isShowHeader=!e.isShowHeader,setLocalStorage("setting",e.isShowHeader))};e.shortUserName=function(n){return n?n.split(" ").slice(0,2).map(n=>n.substring(0,1)).join(""):"Unknown"};e.changePassword=function(){var t=baseAppPath+"/shared/views/modal/",n=f.open({templateUrl:t+"changePassword.html"+versionTemplate,controller:"Shared.changePassword as $vm",backdrop:"static",size:"md"});n.opened.then(function(){$(document).ready(function(){$(".modal-footer").addClass("remove-modal-footer")})});n.result.then(function(){},function(n){typeof n=="object"})};e.isFullScreen=!1;e.toogleFullScreen=function(){e.isFullScreenSupport&&($.fullscreen.isFullScreen()?($.fullscreen.exit(),e.isFullScreen=!1):(e.isFullScreen=!0,$("html").fullscreen({overflow:"visible"})))};o=function(){e.isFullScreenSupport=$.fullscreen.isNativelySupported()};o();e.logOut=function(){r.logout().then(function(n){n&&n.Id>0&&setTimeout(function(){localStorage.removeItem("bearer");deleteCookie("AUTH_");t.isReloading=!1;u.success("Đăng xuất thành công");i.go("auth.login")},1e3)})}}])})(),function(){app.controller("Shared.LeftMenu",["$scope","$rootScope","$state","sessionService",function(n,t,i,r){var u=this,f=window.location.pathname;f=f=="/auth/login"?"/":window.location.pathname;u.groupMenu=r.getUserRole();u.init=function(){var n=u.groupMenu.filter(n=>n.IsShowMenu==!0);u.groupMenu=n.length>0?Enumerable.From(n).GroupBy(function(n){return n.ControllerName}).Select(function(n){return{ControllerName:n.source[0].ControllerName,data:Enumerable.From(n.source).OrderBy("$.Sort").ToArray(),content:n.source[0].ControllerName!="home"?"root."+n.source[0].ControllerName.replaceAll("-",""):"root.home",root:n.source[0].root,url:n.source[0].url,PermissionName:n.source[0].PermissionName,icon:n.source[0].CssIcon,sort:n.source[0].Sort}}).OrderBy("$.sort").ToArray():Enumerable.From(u.groupMenu).GroupBy(function(n){return n.ControllerName}).Select(function(n){return{ControllerName:n.source[0].ControllerName,data:Enumerable.From(n.source).OrderBy("$.Sort").ToArray(),content:n.source[0].ControllerName!="home"?"root."+n.source[0].ControllerName.replaceAll("-",""):"root.home",root:n.source[0].root,url:n.source[0].url,PermissionName:n.source[0].PermissionName,icon:n.source[0].CssIcon,sort:n.source[0].Sort}}).OrderBy("$.sort").ToArray()};u.init();console.log("groupMenu.data",u.groupMenu);u.checkClass=function(n){return n==i.current.name};u.checkMenu=function(n){return i.current.name.includes(n)}}])}(),function(){app.controller("Shared.Main",["$scope","$rootScope","$state",function(n,t){var i=this;t.openRecordingURL=function(n){window.open(n,"_blank")}}])}(),function(){app.controller("Shared.changePassword",["$scope","$rootScope","$state","$uibModalInstance","authService","notificationService",function(n,t,i,r,u,f){var e=this;e.isSaving=!1;e.userInfo={UserId:t.sessionInfo.UserId};e.errorMsg="";e.isShowOldPassword=!1;e.toggleShowOldPassword=function(){var t=document.getElementById("oldPassword"),n=document.getElementById("oldPasswordToggle");e.isShowOldPassword?(e.isShowOldPassword=!e.isShowOldPassword,t.type="password",n.classList.remove("fa-eye-slash"),n.classList.add("fa-eye")):(e.isShowOldPassword=!e.isShowOldPassword,t.type="text",n.classList.remove("fa-eye"),n.classList.add("fa-eye-slash"))};e.isShowNewPassword=!1;e.toggleShowNewPassword=function(){var t=document.getElementById("newPassword"),n=document.getElementById("newPasswordToggle");e.isShowNewPassword?(e.isShowNewPassword=!e.isShowNewPassword,t.type="password",n.classList.remove("fa-eye-slash"),n.classList.add("fa-eye")):(e.isShowNewPassword=!e.isShowNewPassword,t.type="text",n.classList.remove("fa-eye"),n.classList.add("fa-eye-slash"))};e.isShowReNewPassword=!1;e.toggleShowReNewPassword=function(){var t=document.getElementById("reNewPassword"),n=document.getElementById("reNewPasswordToggle");e.isShowReNewPassword?(e.isShowReNewPassword=!e.isShowReNewPassword,t.type="password",n.classList.remove("fa-eye-slash"),n.classList.add("fa-eye")):(e.isShowReNewPassword=!e.isShowReNewPassword,t.type="text",n.classList.remove("fa-eye"),n.classList.add("fa-eye-slash"))};e.save=function(){n.formChangePassword.$valid&&!e.isSaving&&(e.userInfo.NewPassword!==e.userInfo.reNewPassword?e.errorMsg="Nhập lại mật khẩu không đúng.":t.passPattern.test(e.userInfo.NewPassword)?u.changePassword(e.userInfo).then(function(n){n&&n.Id>0?(f.success(n.Message),r.dismiss(n)):e.errorMsg=n.Message}):e.errorMsg="Mật khẩu không đúng định dạng.")};e.cancel=function(){r.close()}}])}(),function(){var n=baseAppPath+"/shared/views/";routes.root={url:"",abstract:!0,resolve:{auth:["$rootScope","authService","$state","$q","sessionService",function(n,t,i,r,u){var f=r.defer();return r.when(t.getSession()).then(function(e){e.UserId==0?setTimeout(function(){r.when(t.getSession()).then(function(r){r&&r.UserRoleId>0?(n.sessionInfo=r,t.getUserPermission({userRoleId:r.UserRoleId}).then(function(n){n.forEach(function(n){n.url=n.ControllerName!="home"?"/"+n.ControllerName+"/"+n.RoleName:"/";n.root=n.ControllerName!="home"?"root."+n.ControllerName.replaceAll("-","")+"."+n.ActionName:"root.home"});u.setUserRole(n);f.resolve(n)})):i.go("auth.login")})},500):e&&e.UserRoleId>0?(n.sessionInfo=e,t.getUserPermission({userRoleId:e.UserRoleId}).then(function(n){n.forEach(function(n){n.url=n.ControllerName!="home"?"/"+n.ControllerName+"/"+n.RoleName:"/";n.root=n.ControllerName!="home"?"root."+n.ControllerName.replaceAll("-","")+"."+n.ActionName:"root.home"});u.setUserRole(n);f.resolve(n)})):i.go("auth.login")}),f.promise}]},views:{"":{templateUrl:n+"_layout.html"+versionTemplate,controller:"Shared.Main as $vm"},"header@root":{templateUrl:n+"header.html"+versionTemplate,controller:"Shared.Header as $vm"},"left-menu@root":{templateUrl:n+"leftMenu.html"+versionTemplate,controller:"Shared.LeftMenu as $vm"}}}}(),function(){app.service("ddlService",["baseService",function(n){var t=n.baseUrl+"/BaseDDL";this.lotteryChannelDDL=function(i){var r=t+"/LotteryChannelDDL";return n.getData(r,i)};this.agencyDDL=function(){var i=t+"/AgencyDDL";return n.getData(i)};this.salePointDDL=function(){var i=t+"/SalePointDDL";return n.getData(i)};this.userByTitleDDL=function(i){var r=t+"/UserByTitleDDL";return n.getData(r,i)};this.userTitleDDL=function(i){var r=t+"/UserTitleDDL";return n.getData(r,i)};this.getUserTitleDDL=function(){var i=t+"/GetUserTitleDDL";return n.getData(i)};this.lotteryTypeDDL=function(){var i=t+"/LotteryTypeDDL";return n.getData(i)};this.lotteryPriceDDL=function(i){var r=t+"/LotteryPriceDDL";return n.getData(r,i)};this.winningTypeDDL=function(){var i=t+"/WinningTypeDDL";return n.getData(i)};this.getItemDDL=function(){var i=t+"/GetItemDDL";return n.getData(i)};this.getUnitDDL=function(){var i=t+"/GetUnitDDL";return n.getData(i)};this.getGuestDDL=function(i){var r=t+"/GetGuestDDL";return n.getData(r,i)};this.getTypeOfItemDDL=function(){var i=t+"/GetTypeOfItemDDL";return n.getData(i)};this.getTypeNameDDL=function(i){var r=t+"/GetTypeNameDDL";return n.getData(r,i)};this.getUserDDL=function(i){var r=t+"/GetUserDDL";return n.getData(r,i)};this.getCriteriaDDL=function(i){var r=t+"/GetCriteriaDDL";return n.getData(r,i)};this.reportWinningTypeDDL=function(){var i=t+"/ReportWinningTypeDDL";return n.getData(i)};this.internByTitleDDL=function(i){var r=t+"/InternByTitleDDL";return n.getData(r,i)};this.subAgencyDDL=function(i){var r=t+"/SubAgencyDDL";return n.getData(r,i)}}])}(),function(){angular.module("KTHubApp").service("sessionService",["$rootScope",function(n){var t=[];this.setUserRole=function(i){t=i;n.$broadcast("event:role-change",{some:"data"})};this.getUserRole=function(){return t}}])}();